<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <title>{% block htmltitle %}{{ page_title }}{% endblock %}</title>
    {% block htmlhead %}
        <link rel="stylesheet" type="text/css" href="{{ url_for('rhino-static', path="css/reset.css") }}">
        <link rel="stylesheet" type="text/css" href="{{ url_for('rhino-static', path="css/text.css") }}">
        <link rel="stylesheet" type="text/css" href="{{ url_for('rhino-static', path="css/style.css") }}">
        <link rel="stylesheet" type="text/css" href="{{ url_for('rhino-static', path="css/extrastyle.css") }}">

        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    {% endblock %}
</head><body>

    {% if not user.is_anonymous() %}
    <div id="settings">
        <div id="settings-inner">
            {% block settings %}
                <div class="signin-services">
                    <span>Add another account:</span>
                    <a href="{{ url_for('signin-twitter') }}" title="Sign in with Twitter"><img src="{{ url_for('rhino-static', path='komodo/twitter_32.png') }}" width="32" height="32" alt="Twitter"></a>
                    <a href="{{ url_for('signin-typepad') }}" title="Sign in with TypePad"><img src="{{ url_for('rhino-static', path='img/typepad-komodo-style-20100311-32px.png') }}" width="32" height="32" alt="TypePad"></a>
                    <a href="{{ url_for('signin-flickr') }}" title="Sign in with Flickr"><img src="{{ url_for('rhino-static', path='komodo/flickr_32.png') }}" width="32" height="32" alt="Flickr"></a>
                </div>
            {% endblock %}
        </div>
    </div>

    <div id="bar">
        <div id="gear"><a href="#">&#9881;</a></div>
    </div>
    {% endif %}

    <div id="content">
        {% block content %}{% endblock %}
    </div>

    <script type="text/javascript">
    function spinGear(i) {
        i++;

        var gearAngle = (18 * i) % 360;

        var transform = 'rotate(' + gearAngle + 'deg)';
        var $gear = $('#gear');
        $gear.css({
            '-moz-transform': transform,
            '-webkit-transform': transform,
            'transform': transform,
        }).addClass('spinning');

        if (i == 20) {
            $gear.removeClass('spinning');
            return;
        }
        $gear.delay(40).queue(function (next) {
            spinGear(i);
            next();
        });
    }

    $(document).ready(function () {
        $('#gear').click(function () {
            $('#settings').animate({'height': $('#settings').height() ? '0px' : '200px'}, 'slow');
            spinGear(0);
            return false;
        });
    });
    </script>

{% if ganalytics_code %}
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', '{{ ganalytics_code }}']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
{% endif %}

{% if zendesk %}
<div id="zendesk-dropbox" class="ZenboxTabLeft"></div>

<script type="text/javascript" src="//asset0.zendesk.com/external/zenbox/zenbox-2.0.js"></script>
<style type="text/css" media="screen, projection">
  @import url(//asset0.zendesk.com/external/zenbox/zenbox-2.0.css);
</style>
<script type="text/javascript">
    if (typeof(Zenbox) !== "undefined") {
        Zenbox.init({
            dropboxID:   "{{ zendesk.dropbox_id }}",
            url:         "{{ zendesk.url }}",
            tabID:       "{{ zendesk.tab_id or "feedback" }}",
            tabColor:    "{{ zendesk.tab_color or "black" }}",
            tabPosition: "{{ zendesk.tab_position or "Left" }}",
            hide_tab:    true
        });
    }
    $(document).ready(function () {
        $('#zendesk-dropbox').click(function () {
            Zenbox.is_rendered = false;
            Zenbox.show();
            return false;
        });
    });
</script>
{% endif %}

{% if uservoice %}
<script type="text/javascript">
var uservoiceOptions = {
  /* required */
  key: '{{ uservoice.key }}',
  host: '{{ uservoice.host }}',
  forum: '{{ uservoice.forum }}',
  showTab: true,
  /* optional */
  alignment: 'left',
  background_color:'black',
  text_color: 'white',
  hover_color: '#063',
  lang: 'en'
};

function _loadUserVoice() {
  var s = document.createElement('script');
  s.setAttribute('type', 'text/javascript');
  s.setAttribute('src', ("https:" == document.location.protocol ? "https://" : "http://") + "cdn.uservoice.com/javascripts/widgets/tab.js");
  document.getElementsByTagName('head')[0].appendChild(s);
}
_loadSuper = window.onload;
window.onload = (typeof window.onload != 'function') ? _loadUserVoice : function() { _loadSuper(); _loadUserVoice(); };
</script>
{% endif %}

</body></html>
